ğŸ« ì‹ê¶Œ êµ¬ë§¤ & QR ê²°ì œ ì‹œìŠ¤í…œ (Replit í”„ë¡œí† íƒ€ì…)
ì‹œìŠ¤í…œ ê°œìš”
ì•±ì„ í†µí•´ ì‹ë‹¹ ë©”ë‰´ë¥¼ ë¯¸ë¦¬ ì£¼ë¬¸/ê²°ì œí•˜ê³ , ì‹ë‹¹ ë„ì°© ì‹œ QR ì½”ë“œë¥¼ í™œì„±í™”í•˜ì—¬ ìŒì‹ì„ ìˆ˜ë ¹í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ê¸°ì¡´ í‚¤ì˜¤ìŠ¤í¬ ëŒ€ê¸°ì¤„ì„ ê±´ë„ˆë›°ê³  ë¹ ë¥´ê²Œ ìˆ˜ë ¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í•µì‹¬ ì»¨ì…‰: 3ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤
1ï¸âƒ£ ë¯¸ë¦¬ ì£¼ë¬¸ & ê²°ì œ
   â†’ ì‹ê¶Œ ë³´ê´€í•¨ì— ì €ì¥ (QR ë¯¸ìƒì„±)

2ï¸âƒ£ ì‹ë‹¹ ë„ì°© í›„ QR í™œì„±í™”
   â†’ GPS ì¸ì¦ (50m ì´ë‚´)
   â†’ QR ìƒì„± (3ë¶„ ìœ íš¨)

3ï¸âƒ£ QR ìŠ¤ìº” & ìŒì‹ ìˆ˜ë ¹
   â†’ ëŒ€ê¸°ì¤„ ê±´ë„ˆë›°ê¸°

1. ì‚¬ìš©ì í”Œë¡œìš°
í”Œë¡œìš° A: ë¯¸ë¦¬ ì£¼ë¬¸ (ì¶”ì²œ)
[11:50 ìˆ˜ì—… ì¤‘]
í•™ìƒ: ì•±ì—ì„œ í•œì–‘í”Œë¼ì ë©”ë‰´ í™•ì¸
    â†’ "ì¹˜ì¦ˆëˆê¹ŒìŠ¤" ì„ íƒ
    â†’ [ì£¼ë¬¸í•˜ê¸°] í´ë¦­
    
í•™ìƒ: ìˆ˜ë ¹ ì‹œê°„ ì„ íƒ
    â†’ "12:30 ì§€ì •" ì„ íƒ
    
í•™ìƒ: ê²°ì œ (ì¹´ì¹´ì˜¤í˜ì´)
    â†’ â‚©4,200 ê²°ì œ ì™„ë£Œ
    
ì•±: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… ê²°ì œ ì™„ë£Œ!           â”‚
    â”‚                         â”‚
    â”‚ ì£¼ë¬¸ #47                â”‚
    â”‚ ì¹˜ì¦ˆëˆê¹ŒìŠ¤ â‚©4,200       â”‚
    â”‚                         â”‚
    â”‚ ğŸ“¦ ì‹ê¶Œ ë³´ê´€í•¨ì— ì €ì¥ë¨ â”‚  â† QR ì—†ìŒ
    â”‚                         â”‚
    â”‚ ì‹ë‹¹ ë„ì°© í›„            â”‚
    â”‚ QRì„ í™œì„±í™”í•´ì£¼ì„¸ìš”     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[12:25 ìˆ˜ì—… ë]
í•™ìƒ: ì‹ë‹¹ìœ¼ë¡œ ì´ë™

[12:28 ì‹ë‹¹ ë„ì°©]
í•™ìƒ: ì•± ì—´ê¸° â†’ "ì£¼ë¬¸" íƒ­
    â†’ [QR í™œì„±í™”] ë²„íŠ¼ í´ë¦­
    
ì•±: GPS í™•ì¸ ì¤‘... âœ… ì‹œì„¤ 50m ì´ë‚´
    
ì•±: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… QR í™œì„±í™”ë¨          â”‚
    â”‚                         â”‚
    â”‚  [  QR CODE  ]          â”‚
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â”‚
    â”‚                         â”‚
    â”‚  â±ï¸ ë‚¨ì€ ì‹œê°„: 2:58    â”‚  â† ì‹¤ì‹œê°„ ì¹´ìš´íŠ¸ë‹¤ìš´
    â”‚                         â”‚
    â”‚ 12:31ê¹Œì§€ ìŠ¤ìº”í•´ì£¼ì„¸ìš”  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•™ìƒ: ì‹ê¶Œ ì œì¶œëŒ€ë¡œ ì´ë™
    â†’ QR ìŠ¤ìº”
    â†’ ìŒì‹ ìˆ˜ë ¹! ğŸ½ï¸
í”Œë¡œìš° B: í˜„ì¥ì—ì„œ ì£¼ë¬¸
[12:20 ì‹ë‹¹ ë„ì°©]
í•™ìƒ: ì•±ì—ì„œ ë©”ë‰´ ì„ íƒ â†’ ì£¼ë¬¸
    â†’ ìˆ˜ë ¹ ì‹œê°„: "ì§€ê¸ˆ ë°”ë¡œ"
    â†’ ê²°ì œ ì™„ë£Œ
    
í•™ìƒ: [QR í™œì„±í™”] ë²„íŠ¼ í´ë¦­ (GPS í™•ì¸)
    â†’ QR ìƒì„± (3ë¶„ ìœ íš¨)
    â†’ ì˜ˆìƒ ëŒ€ê¸°: 5ë¶„
    
í•™ìƒ: 5ë¶„ í›„ QR ìŠ¤ìº” â†’ ìˆ˜ë ¹
í”Œë¡œìš° C: QR ë§Œë£Œ í›„ ì¬í™œì„±í™”
[12:25 QR í™œì„±í™”]
ì•±: â±ï¸ 2:58... 2:57... 

[12:28 3ë¶„ ê²½ê³¼]
ì•±: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â° QR ì½”ë“œ ë§Œë£Œ         â”‚
    â”‚                         â”‚
    â”‚  [  ë§Œë£Œëœ QR  ]        â”‚  â† íë¦¬ê²Œ
    â”‚  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘           â”‚
    â”‚                         â”‚
    â”‚ [ë‹¤ì‹œ í™œì„±í™”]           â”‚  â† ì¬í™œì„±í™” ê°€ëŠ¥
    â”‚                         â”‚
    â”‚ ì‹ë‹¹ ê·¼ì²˜ì—ì„œ            â”‚
    â”‚ ë‹¤ì‹œ í™œì„±í™”í•´ì£¼ì„¸ìš”      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•™ìƒ: [ë‹¤ì‹œ í™œì„±í™”] í´ë¦­
    â†’ GPS ì¬í™•ì¸ âœ…
    â†’ ìƒˆ QR ìƒì„± (ë‹¤ì‹œ 3ë¶„)
    â†’ ìŠ¤ìº” â†’ ìˆ˜ë ¹

2. í™”ë©´ êµ¬ì„±
2.1 ë©”ë‰´ ì¹´ë“œ (ìˆ˜ì •: ì£¼ë¬¸ ë²„íŠ¼ ì¶”ê°€)
jsx<CongestionCard corner={corner}>
  <CardContent className="p-4">
    {/* ê¸°ì¡´: ì½”ë„ˆ ì •ë³´, í˜¼ì¡ë„ */}
    <div className="flex justify-between items-start mb-3">
      <div className="flex-1">
        <Badge variant="outline">{corner.type}</Badge>
        <h3 className="font-semibold text-lg">{corner.menu}</h3>
        <p className="text-sm text-gray-600">â‚©{corner.price.toLocaleString()}</p>
      </div>
      <CongestionBar level={corner.congestion} />
    </div>

    {/* ì‹ ê·œ: ì•¡ì…˜ ë²„íŠ¼ 2ê°œ */}
    <div className="flex gap-2">
      <Button 
        variant="outline" 
        size="sm" 
        className="flex-1"
        onClick={() => handleWaitingRegister(corner)}
      >
        <Clock className="w-4 h-4 mr-1" />
        ëŒ€ê¸° ë“±ë¡
      </Button>
      
      <Button 
        size="sm" 
        className="flex-1"
        onClick={() => handleAddToCart(corner)}
      >
        <ShoppingCart className="w-4 h-4 mr-1" />
        ì£¼ë¬¸í•˜ê¸°
      </Button>
    </div>
  </CardContent>
</CongestionCard>
2.2 ì¥ë°”êµ¬ë‹ˆ ëª¨ë‹¬ (í•˜ë‹¨ ì‹œíŠ¸)
jsx<Sheet open={showCart} onOpenChange={setShowCart}>
  <SheetContent side="bottom" className="h-[85vh] rounded-t-2xl">
    <SheetHeader>
      <SheetTitle className="text-xl">ì¥ë°”êµ¬ë‹ˆ</SheetTitle>
      <SheetDescription>
        {facility.name} Â· {corner.type} ì½”ë„ˆ
      </SheetDescription>
    </SheetHeader>

    <ScrollArea className="h-[calc(100%-200px)] mt-4">
      <div className="space-y-3">
        {/* ì£¼ë¬¸ ì•„ì´í…œ */}
        {cartItems.map(item => (
          <div key={item.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
            {/* ì¢Œì¸¡: ë©”ë‰´ ì •ë³´ */}
            <div className="flex-1">
              <p className="font-semibold">{item.menu}</p>
              <p className="text-xs text-gray-600">
                {item.facilityName} - {item.cornerType}
              </p>
            </div>

            {/* ì¤‘ì•™: ìˆ˜ëŸ‰ ì¡°ì ˆ */}
            <div className="flex items-center gap-2 mx-4">
              <Button 
                size="icon" 
                variant="outline" 
                className="h-8 w-8"
                onClick={() => decreaseQuantity(item.id)}
                disabled={item.quantity <= 1}
              >
                <Minus className="w-3 h-3" />
              </Button>
              
              <span className="font-semibold w-8 text-center">
                {item.quantity}
              </span>
              
              <Button 
                size="icon" 
                variant="outline" 
                className="h-8 w-8"
                onClick={() => increaseQuantity(item.id)}
                disabled={item.quantity >= 5}
              >
                <Plus className="w-3 h-3" />
              </Button>
            </div>

            {/* ìš°ì¸¡: ê°€ê²© */}
            <div className="text-right w-20">
              <p className="font-semibold">
                â‚©{(item.price * item.quantity).toLocaleString()}
              </p>
              <Button 
                size="sm" 
                variant="ghost" 
                className="h-6 p-0"
                onClick={() => removeItem(item.id)}
              >
                <X className="w-4 h-4 text-gray-400" />
              </Button>
            </div>
          </div>
        ))}
      </div>

      <Separator className="my-4" />

      {/* ìˆ˜ë ¹ ì‹œê°„ ì„ íƒ */}
      <Card className="border-2">
        <CardHeader>
          <CardTitle className="text-base flex items-center gap-2">
            <Clock className="w-5 h-5" />
            ìˆ˜ë ¹ ì‹œê°„
          </CardTitle>
        </CardHeader>
        <CardContent className="space-y-3">
          <RadioGroup value={pickupType} onValueChange={setPickupType}>
            {/* ì§€ê¸ˆ ë°”ë¡œ */}
            <div className="flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
              <RadioGroupItem value="now" id="now" />
              <Label htmlFor="now" className="flex-1 cursor-pointer">
                <p className="font-semibold">ì§€ê¸ˆ ë°”ë¡œ</p>
                <p className="text-xs text-gray-600">
                  ì˜ˆìƒ ëŒ€ê¸°: {estimatedWaitTime}ë¶„
                </p>
              </Label>
            </div>

            {/* ì‹œê°„ ì§€ì • */}
            <div className="flex items-center space-x-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
              <RadioGroupItem value="scheduled" id="scheduled" />
              <Label htmlFor="scheduled" className="flex-1 cursor-pointer">
                <p className="font-semibold">ì‹œê°„ ì§€ì •</p>
                <p className="text-xs text-gray-600">
                  ì›í•˜ëŠ” ì‹œê°„ì— ìˆ˜ë ¹
                </p>
              </Label>
            </div>
          </RadioGroup>

          {/* ì‹œê°„ ì§€ì • ì‹œ ì‹œê°„ ì„ íƒ */}
          {pickupType === 'scheduled' && (
            <div className="pt-2 space-y-2">
              <Label className="text-sm text-gray-600">ìˆ˜ë ¹ ì‹œê°„ ì„ íƒ</Label>
              <div className="grid grid-cols-2 gap-2">
                <Select value={scheduledHour} onValueChange={setScheduledHour}>
                  <SelectTrigger>
                    <SelectValue placeholder="ì‹œ" />
                  </SelectTrigger>
                  <SelectContent>
                    {generateAvailableHours().map(h => (
                      <SelectItem key={h} value={h}>
                        {h}ì‹œ
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>

                <Select value={scheduledMinute} onValueChange={setScheduledMinute}>
                  <SelectTrigger>
                    <SelectValue placeholder="ë¶„" />
                  </SelectTrigger>
                  <SelectContent>
                    {['00', '15', '30', '45'].map(m => (
                      <SelectItem key={m} value={m}>
                        {m}ë¶„
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>
              
              {scheduledHour && scheduledMinute && (
                <Alert>
                  <AlertDescription className="text-sm">
                    {scheduledHour}:{scheduledMinute}ì— ìˆ˜ë ¹ ê°€ëŠ¥í•˜ë„ë¡ ì¤€ë¹„ë©ë‹ˆë‹¤
                  </AlertDescription>
                </Alert>
              )}
            </div>
          )}
        </CardContent>
      </Card>
    </ScrollArea>

    {/* í•˜ë‹¨ ê³ ì •: ì´ ê¸ˆì•¡ & ê²°ì œ ë²„íŠ¼ */}
    <div className="absolute bottom-0 left-0 right-0 bg-white border-t p-4">
      <div className="space-y-2 mb-3">
        <div className="flex justify-between text-sm">
          <span className="text-gray-600">ë©”ë‰´ ê¸ˆì•¡</span>
          <span className="font-semibold">â‚©{totalAmount.toLocaleString()}</span>
        </div>
        <div className="flex justify-between text-lg font-bold">
          <span>ì´ ê²°ì œê¸ˆì•¡</span>
          <span className="text-blue-600">â‚©{totalAmount.toLocaleString()}</span>
        </div>
      </div>

      <Button 
        className="w-full h-14 text-lg"
        onClick={handleProceedToPayment}
        disabled={cartItems.length === 0}
      >
        â‚©{totalAmount.toLocaleString()} ê²°ì œí•˜ê¸°
      </Button>
    </div>
  </SheetContent>
</Sheet>
2.3 ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ëª¨ë‹¬
jsx<Dialog open={showPaymentDialog} onOpenChange={setShowPaymentDialog}>
  <DialogContent className="max-w-md">
    <DialogHeader>
      <DialogTitle className="text-xl">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</DialogTitle>
      <DialogDescription>
        ì´ â‚©{totalAmount.toLocaleString()}
      </DialogDescription>
    </DialogHeader>

    <div className="space-y-2 my-4">
      {/* ì¹´ì¹´ì˜¤í˜ì´ */}
      <Button
        variant="outline"
        className="w-full h-16 justify-start text-left"
        onClick={() => processPayment('kakao')}
      >
        <div className="flex items-center gap-3">
          <div className="w-10 h-10 bg-yellow-400 rounded-lg flex items-center justify-center">
            <span className="font-bold text-sm">KAKAO</span>
          </div>
          <div>
            <p className="font-semibold">ì¹´ì¹´ì˜¤í˜ì´</p>
            <p className="text-xs text-gray-500">ê°„í¸ê²°ì œ</p>
          </div>
        </div>
        <ChevronRight className="ml-auto w-5 h-5 text-gray-400" />
      </Button>

      {/* í† ìŠ¤í˜ì´ */}
      <Button
        variant="outline"
        className="w-full h-16 justify-start text-left"
        onClick={() => processPayment('toss')}
      >
        <div className="flex items-center gap-3">
          <div className="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
            <span className="font-bold text-white text-sm">toss</span>
          </div>
          <div>
            <p className="font-semibold">í† ìŠ¤í˜ì´</p>
            <p className="text-xs text-gray-500">ê°„í¸ê²°ì œ</p>
          </div>
        </div>
        <ChevronRight className="ml-auto w-5 h-5 text-gray-400" />
      </Button>

      {/* ì¹´ë“œ ê²°ì œ */}
      <Button
        variant="outline"
        className="w-full h-16 justify-start text-left"
        onClick={() => processPayment('card')}
      >
        <div className="flex items-center gap-3">
          <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
            <CreditCard className="w-6 h-6 text-gray-600" />
          </div>
          <div>
            <p className="font-semibold">ì‹ ìš©/ì²´í¬ì¹´ë“œ</p>
            <p className="text-xs text-gray-500">ì¼ë°˜ê²°ì œ</p>
          </div>
        </div>
        <ChevronRight className="ml-auto w-5 h-5 text-gray-400" />
      </Button>

      {/* í•™ìƒ ì‹ê¶Œ (ì¶©ì „ì‹) - Optional */}
      <Button
        variant="outline"
        className="w-full h-16 justify-start text-left"
        onClick={() => processPayment('meal_card')}
      >
        <div className="flex items-center gap-3">
          <div className="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
            <Ticket className="w-6 h-6 text-purple-600" />
          </div>
          <div className="flex-1">
            <p className="font-semibold">í•™ìƒ ì‹ê¶Œ</p>
            <p className="text-xs text-gray-500">ì”ì•¡: â‚©15,000</p>
          </div>
        </div>
        <ChevronRight className="ml-auto w-5 h-5 text-gray-400" />
      </Button>
    </div>

    <DialogFooter>
      <Button 
        variant="ghost" 
        className="w-full"
        onClick={() => setShowPaymentDialog(false)}
      >
        ì·¨ì†Œ
      </Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
2.4 ê²°ì œ ì™„ë£Œ í™”ë©´ (ì‹ê¶Œ ë³´ê´€í•¨ ì €ì¥)
jsx<div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4">
  <Card className="w-full max-w-md">
    {/* ì„±ê³µ ì•„ì´ì½˜ */}
    <CardHeader className="text-center pb-3">
      <div className="mx-auto mb-4 h-20 w-20 rounded-full bg-green-100 flex items-center justify-center animate-bounce-once">
        <CheckCircle className="h-12 w-12 text-green-600" />
      </div>
      <CardTitle className="text-2xl font-bold">ê²°ì œ ì™„ë£Œ!</CardTitle>
      <CardDescription className="text-base">
        ì‹ê¶Œì´ ë³´ê´€í•¨ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤
      </CardDescription>
    </CardHeader>

    <CardContent className="space-y-4">
      {/* ì£¼ë¬¸ ì •ë³´ */}
      <div className="bg-white rounded-lg p-4 border-2 border-gray-200">
        <div className="flex items-start justify-between mb-3">
          <div>
            <p className="text-sm text-gray-600">ì£¼ë¬¸ë²ˆí˜¸</p>
            <p className="text-2xl font-bold text-blue-600">#{orderNumber}</p>
          </div>
          <Badge variant="secondary" className="text-sm">
            ê²°ì œ ì™„ë£Œ
          </Badge>
        </div>

        <Separator className="my-3" />

        <div className="space-y-2">
          <div>
            <p className="font-semibold text-lg">{facility.name}</p>
            <p className="text-sm text-gray-600">{corner.type} ì½”ë„ˆ</p>
          </div>

          {items.map(item => (
            <div key={item.id} className="flex justify-between text-sm py-1">
              <span className="text-gray-600">
                {item.menu} x{item.quantity}
              </span>
              <span className="font-semibold">
                â‚©{(item.price * item.quantity).toLocaleString()}
              </span>
            </div>
          ))}

          <Separator className="my-2" />

          <div className="flex justify-between font-bold text-lg">
            <span>ê²°ì œê¸ˆì•¡</span>
            <span className="text-blue-600">
              â‚©{totalAmount.toLocaleString()}
            </span>
          </div>
        </div>
      </div>

      {/* ìˆ˜ë ¹ ì‹œê°„ */}
      <Alert className="border-2 border-blue-200 bg-blue-50">
        <Clock className="h-5 w-5 text-blue-600" />
        <AlertTitle className="text-blue-900 font-semibold">
          ìˆ˜ë ¹ ì˜ˆì • ì‹œê°„
        </AlertTitle>
        <AlertDescription className="text-blue-800">
          {pickupType === 'now' 
            ? `ì§€ê¸ˆë¶€í„° ~ ${formatTime(expiryTime)} (ì•½ ${estimatedWaitTime}ë¶„)`
            : `${scheduledTime} ~ ${formatTime(expiryTime)}`
          }
        </AlertDescription>
      </Alert>

      {/* ì¤‘ìš”: QR í™œì„±í™” ì•ˆë‚´ */}
      <Card className="border-2 border-orange-200 bg-orange-50">
        <CardContent className="p-4">
          <div className="flex gap-3">
            <div className="flex-shrink-0">
              <div className="w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center">
                <QrCode className="w-7 h-7 text-orange-600" />
              </div>
            </div>
            <div className="flex-1">
              <p className="font-semibold text-orange-900 mb-1">
                ğŸ“¦ ì‹ê¶Œ ë³´ê´€í•¨ì— ì €ì¥ë¨
              </p>
              <p className="text-sm text-orange-800 leading-relaxed">
                ì‹ë‹¹ ë„ì°© í›„ "ì£¼ë¬¸" íƒ­ì—ì„œ <span className="font-semibold">QRì„ í™œì„±í™”</span>í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”
              </p>
            </div>
          </div>
        </CardContent>
      </Card>

      {/* ì•ˆë‚´ì‚¬í•­ */}
      <div className="text-xs text-gray-500 space-y-1 bg-gray-50 rounded-lg p-3">
        <p className="font-semibold text-gray-700 mb-2">ğŸ“Œ ì•ˆë‚´ì‚¬í•­</p>
        <p>â€¢ QRì€ ì‹ë‹¹ ê·¼ì²˜(50m ì´ë‚´)ì—ì„œë§Œ í™œì„±í™”ë©ë‹ˆë‹¤</p>
        <p>â€¢ í™œì„±í™”ëœ QRì€ 3ë¶„ê°„ ìœ íš¨í•©ë‹ˆë‹¤</p>
        <p>â€¢ ë§Œë£Œ ì‹œ ì¬í™œì„±í™” ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
        <p>â€¢ ì·¨ì†Œ/í™˜ë¶ˆì€ ìˆ˜ë ¹ ì „ê¹Œì§€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
      </div>
    </CardContent>

    <CardFooter className="flex flex-col gap-2">
      <Button 
        className="w-full h-12"
        onClick={() => navigate('/orders')}
      >
        <ShoppingBag className="w-5 h-5 mr-2" />
        ë‚´ ì£¼ë¬¸ ë³´ê¸°
      </Button>
      <Button 
        variant="outline" 
        className="w-full"
        onClick={() => navigate('/')}
      >
        í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
      </Button>
    </CardFooter>
  </Card>
</div>
2.5 ì£¼ë¬¸ ëª©ë¡ í™”ë©´ (ìƒˆ íƒ­ ì¶”ê°€)
jsxconst OrdersPage = () => {
  const { orders } = useOrders();
  const activeOrders = orders.filter(o => ['PAID', 'QR_ACTIVE'].includes(o.status));
  const completedOrders = orders.filter(o => o.status === 'COMPLETED');

  return (
    <div className="min-h-screen bg-gray-50 pb-20">
      {/* í—¤ë” */}
      <header className="sticky top-0 bg-white border-b z-10 px-4 py-4">
        <h1 className="text-2xl font-bold">ë‚´ ì£¼ë¬¸</h1>
      </header>

      <div className="p-4 space-y-6">
        {/* í™œì„± ì£¼ë¬¸ (ì‹ê¶Œ ë³´ê´€í•¨) */}
        {activeOrders.length > 0 && (
          <section>
            <div className="flex items-center gap-2 mb-3">
              <Ticket className="w-5 h-5 text-blue-600" />
              <h2 className="font-bold text-lg">ì‹ê¶Œ ë³´ê´€í•¨</h2>
              <Badge variant="secondary">{activeOrders.length}</Badge>
            </div>

            <div className="space-y-3">
              {activeOrders.map(order => (
                <OrderCard key={order.id} order={order} />
              ))}
            </div>
          </section>
        )}

        {/* ë¹ˆ ìƒíƒœ */}
        {activeOrders.length === 0 && (
          <div className="flex flex-col items-center justify-center py-16">
            <ShoppingBag className="w-16 h-16 text-gray-300 mb-4" />
            <p className="text-gray-500 mb-1">ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
            <p className="text-sm text-gray-400">ë©”ë‰´ë¥¼ ì£¼ë¬¸í•´ë³´ì„¸ìš”!</p>
          </div>
        )}

        {/* ì™„ë£Œëœ ì£¼ë¬¸ */}
        {completedOrders.length > 0 && (
          <section>
            <h2 className="font-bold text-lg mb-3">ì´ìš© ë‚´ì—­</h2>
            <div className="space-y-2">
              {completedOrders.map(order => (
                <CompletedOrderCard key={order.id} order={order} />
              ))}
            </div>
          </section>
        )}
      </div>
    </div>
  );
};

// í™œì„± ì£¼ë¬¸ ì¹´ë“œ
const OrderCard = ({ order }) => {
  const [showQR, setShowQR] = useState(false);
  
  return (
    <Card className="border-2 hover:shadow-lg transition-shadow">
      <CardContent className="p-4">
        {/* ì£¼ë¬¸ í—¤ë” */}
        <div className="flex justify-between items-start mb-3">
          <div className="flex-1">
            <p className="font-bold text-lg">{order.facility.name}</p>
            <p className="text-sm text-gray-600">{order.corner.type} ì½”ë„ˆ</p>
            <p className="text-xs text-gray-500 mt-1">
              ì£¼ë¬¸ë²ˆí˜¸ #{order.orderNumber}
            </p>
          </div>
          
          <Badge 
            variant={order.status === 'QR_ACTIVE' ? 'default' : 'secondary'}
            className="text-sm"
          >
            {order.status === 'PAID' ? 'ğŸ’³ ê²°ì œì™„ë£Œ' : 'âœ… QRí™œì„±í™”'}
          </Badge>
        </div>

        {/* ì£¼ë¬¸ í•­ëª© */}
        <div className="bg-gray-50 rounded-lg p-3 mb-3">
          {order.items.map(item => (
            <div key={item.id} className="flex justify-between text-sm py-1">
              <span>{item.menu} x{item.quantity}</span>
              <span className="font-semibold">
                â‚©{(item.price * item.quantity).toLocaleString()}
              </span>
            </div>
          ))}
          <Separator className="my-2" />
          <div className="flex justify-between font-bold">
            <span>ì´ ê¸ˆì•¡</span>
            <span className="text-blue-600">
              â‚©{order.totalAmount.toLocaleString()}
            </span>
          </div>
        </div>

        {/* ìˆ˜ë ¹ ì‹œê°„ */}
        <div className="flex items-center gap-2 text-sm text-gray-600 mb-3">
          <Clock className="w-4 h-4" />
          <span>ìˆ˜ë ¹: {formatPickupTime(order.pickupTime)}</span>
        </div>

        {/* QR ìƒíƒœë³„ ì•¡ì…˜ ë²„íŠ¼ */}
        {order.status === 'PAID' && (
          <Button
            className="w-full h-12"
            onClick={() => handleActivateQR(order)}
          >
            <QrCode className="w-5 h-5 mr-2" />
            QR í™œì„±í™”
          </Button>
        )}

        {order.status === 'QR_ACTIVE' && (
          <Button
            className="w-full h-12"
            onClick={() => setShowQR(true)}
          >
            <Eye className="w-5 h-5 mr-2" />
            QR ë³´ê¸°
          </Button>
        )}

        {/* í•˜ë‹¨ ë§í¬ */}
        <div className="flex gap-2 mt-2">
          {order.status === 'PAID' && (
            <Button
              variant="ghost"
              size="sm"
              className="flex-1 text-red-600"
              onClick={() => handleCancelOrder(order.id)}
            >
              ì£¼ë¬¸ ì·¨ì†Œ
            </Button>
          )}
          <Button
            variant="ghost"
            size="sm"
            className="flex-1"
            onClick={() => navigate(`/orders/${order.id}`)}
          >
            ìƒì„¸ë³´ê¸°
          </Button>
        </div>
      </CardContent>

      {/* QR ëª¨ë‹¬ */}
      {showQR && (
        <QRModal order={order} onClose={() => setShowQR(false)} />
      )}
    </Card>
  );
};
2.6 QR í™œì„±í™” í”„ë¡œì„¸ìŠ¤
jsxconst QRActivationFlow = ({ order, onSuccess, onError }) => {
  const [step, setStep] = useState('idle'); // idle, checking, success, error
  const [distance, setDistance] = useState(null);
  const [errorMessage, setErrorMessage] = useState('');

  const handleActivate = async () => {
    setStep('checking');

    try {
      // 1. GPS ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
      const position = await new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(resolve, reject, {
          enableHighAccuracy: true,
          timeout: 5000,
          maximumAge: 0
        });
      });

      const userLocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };

      // 2. ê±°ë¦¬ ê³„ì‚°
      const dist = calculateDistance(
        userLocation.lat,
        userLocation.lng,
        order.facility.location.lat,
        order.facility.location.lng
      );
      setDistance(Math.round(dist));

      // 3. 50m ì´ë‚´ í™•ì¸
      if (dist > 50) {
        setStep('error');
        setErrorMessage(`ì‹ë‹¹ì—ì„œ ${Math.round(dist)}m ë–¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤`);
        return;
      }

      // 4. ì„œë²„ì— QR í™œì„±í™” ìš”ì²­
      const response = await fetch(`/api/orders/${order.id}/activate-qr`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ userLocation })
      });

      const result = await response.json();

      if (!result.success) {
        setStep('error');
        setErrorMessage(result.message || 'í™œì„±í™” ì‹¤íŒ¨');
        onError?.(result);
        return;
      }

      // 5. ì„±ê³µ
      setStep('success');
      onSuccess?.(result);

    } catch (error) {
      setStep('error');
      setErrorMessage(error.message || 'ìœ„ì¹˜ í™•ì¸ ì‹¤íŒ¨');
      onError?.(error);
    }
  };

  return (
    <div className="space-y-4">
      {/* Idle: í™œì„±í™” ëŒ€ê¸° */}
      {step === 'idle' && (
        <div className="text-center py-8">
          <div className="mx-auto mb-4 h-20 w-20 rounded-full bg-blue-100 flex items-center justify-center">
            <QrCode className="h-10 w-10 text-blue-600" />
          </div>
          <p className="font-semibold text-lg mb-2">ì‹ë‹¹ ê·¼ì²˜ì—ì„œ QRì„ í™œì„±í™”í•˜ì„¸ìš”</p>
          <p className="text-sm text-gray-600 mb-4">
            {order.facility.name} 50m ì´ë‚´ì—ì„œë§Œ í™œì„±í™”ë©ë‹ˆë‹¤
          </p>
          <Button 
            className="w-full h-12"
            onClick={handleActivate}
          >
            <MapPin className="w-5 h-5 mr-2" />
            QR í™œì„±í™”
          </Button>
        </div>
      )}

      {/* Checking: ìœ„ì¹˜ í™•ì¸ ì¤‘ */}
      {step === 'checking' && (
        <div className="text-center py-8">
          <div className="mx-auto mb-4 h-20 w-20 rounded-full bg-blue-100 flex items-center justify-center animate-pulse">
            <MapPin className="h-10 w-10 text-blue-600 animate-bounce" />
          </div>
          <p className="font-semibold text-lg mb-2">ìœ„ì¹˜ í™•ì¸ ì¤‘...</p>
          <p className="text-sm text-gray-600">
            GPSë¡œ í˜„ì¬ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤
          </p>
        </div>
      )}

      {/* Error: í™œì„±í™” ì‹¤íŒ¨ */}
      {step === 'error' && (
        <div className="text-center py-8">
          <div className="mx-auto mb-4 h-20 w-20 rounded-full bg-red-100 flex items-center justify-center">
            <AlertCircle className="h-10 w-10 text-red-600" />
          </div>
          <p className="font-semibold text-lg text-red-900 mb-2">
            í™œì„±í™” ì‹¤íŒ¨
          </p>
          <p className="text-sm text-red-700 mb-4">
            {errorMessage}
          </p>
          {distance && distance > 50 && (
            <Alert variant="destructive" className="mb-4">
              <AlertDescription>
                ì‹ë‹¹ì—ì„œ <span className="font-bold">{distance}m</span> ë–¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤
                <br />
                <span className="font-bold">50m ì´ë‚´</span>ë¡œ ì´ë™í•´ì£¼ì„¸ìš”
              </AlertDescription>
            </Alert>
          )}
          <Button 
            variant="outline"
            className="w-full"
            onClick={handleActivate}
          >
            <RefreshCw className="w-4 h-4 mr-2" />
            ë‹¤ì‹œ ì‹œë„
          </Button>
        </div>
      )}

      {/* Success: í™œì„±í™” ì„±ê³µ - QR í‘œì‹œë¡œ ìë™ ì „í™˜ */}
    </div>
  );
};
2.7 QR ì½”ë“œ í‘œì‹œ ëª¨ë‹¬ (í™œì„±í™” í›„)
jsxconst QRModal = ({ order, onClose }) => {
  const [remainingTime, setRemainingTime] = useState(180); // 3ë¶„ = 180ì´ˆ
  const [isExpired, setIsExpired] = useState(false);

  // íƒ€ì´ë¨¸ (1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸)
  useEffect(() => {
    if (order.status !== 'QR_ACTIVE') return;

    const timer = setInterval(() => {
      const now = new Date();
      const expiresAt = new Date(order.qrExpiresAt);
      const remaining = Math.max(0, Math.floor((expiresAt - now) / 1000));

      setRemainingTime(remaining);

      if (remaining === 0) {
        setIsExpired(true);
        clearInterval(timer);
      }

      // 30ì´ˆ ë‚¨ì•˜ì„ ë•Œ ì§„ë™ ì•Œë¦¼
      if (remaining === 30) {
        navigator.vibrate?.([200, 100, 200]);
      }
    }, 1000);

    return () => clearInterval(timer);
  }, [order]);

  const minutes = Math.floor(remainingTime / 60);
  const seconds = remainingTime % 60;
  const progressPercent = (remainingTime / 180) * 100;
  const isWarning = remainingTime <= 30;

  return (
    <Dialog open={true} onOpenChange={onClose}>
      <DialogContent className="max-w-md">
        <DialogHeader>
          <DialogTitle className="text-center text-xl">
            {isExpired ? 'â° QR ì½”ë“œ ë§Œë£Œ' : 'âœ… QR ì½”ë“œ í™œì„±í™”ë¨'}
          </DialogTitle>
        </DialogHeader>

        <div className="space-y-4">
          {!isExpired ? (
            <>
              {/* QR ì½”ë“œ */}
              <div className="bg-white p-6 rounded-lg border-4 border-dashed border-gray-300">
                <QRCodeSVG
                  value={order.qrCode}
                  size={220}
                  level="H"
                  includeMargin={true}
                  className="mx-auto"
                />
              </div>

              {/* íƒ€ì´ë¨¸ */}
              <div className="text-center">
                <p className="text-sm text-gray-600 mb-2">ë‚¨ì€ ì‹œê°„</p>
                <div className={`text-5xl font-bold mb-2 ${isWarning ? 'text-red-600 animate-pulse' : 'text-blue-600'}`}>
                  {minutes}:{seconds.toString().padStart(2, '0')}
                </div>
                
                {/* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */}
                <div className="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                  <div
                    className={`h-full transition-all duration-1000 ${
                      isWarning ? 'bg-red-500' : 'bg-blue-500'
                    }`}
                    style={{ width: `${progressPercent}%` }}
                  />
                </div>

                <p className="text-sm text-gray-600 mt-2">
                  {formatTime(order.qrExpiresAt)}ê¹Œì§€ ìŠ¤ìº”í•´ì£¼ì„¸ìš”
                </p>

                {isWarning && (
                  <Alert variant="destructive" className="mt-3">
                    <AlertCircle className="h-4 w-4" />
                    <AlertDescription>
                      ê³§ ë§Œë£Œë©ë‹ˆë‹¤! ì„œë‘˜ëŸ¬ ìŠ¤ìº”í•´ì£¼ì„¸ìš”
                    </AlertDescription>
                  </Alert>
                )}
              </div>

              {/* ì£¼ë¬¸ ì •ë³´ */}
              <div className="bg-gray-50 rounded-lg p-3 text-sm">
                <div className="flex justify-between mb-1">
                  <span className="text-gray-600">ì£¼ë¬¸ë²ˆí˜¸</span>
                  <span className="font-semibold">#{order.orderNumber}</span>
                </div>
                <div className="flex justify-between mb-1">
                  <span className="text-gray-600">ì‹ë‹¹</span>
                  <span className="font-semibold">{order.facility.name}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-gray-600">ë©”ë‰´</span>
                  <span className="font-semibold">
                    {order.items.map(i => i.menu).join(', ')}
                  </span>
                </div>
              </div>

              {/* ì•ˆë‚´ */}
              <div className="text-xs text-gray-500 space-y-1">
                <p>â€¢ QR ì½”ë“œë¥¼ ì‹ê¶Œ ì œì¶œëŒ€ì—ì„œ ìŠ¤ìº”í•˜ì„¸ìš”</p>
                <p>â€¢ 1íšŒë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
                <p>â€¢ ë§Œë£Œ ì‹œ ì¬í™œì„±í™” ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
              </div>
            </>
          ) : (
            <>
              {/* ë§Œë£Œëœ QR */}
              <div className="text-center py-8">
                <div className="mx-auto mb-4 h-20 w-20 rounded-full bg-orange-100 flex items-center justify-center">
                  <Clock className="h-10 w-10 text-orange-600" />
                </div>
                <p className="font-semibold text-lg text-orange-900 mb-2">
                  QR ì½”ë“œê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤
                </p>
                <p className="text-sm text-gray-600 mb-4">
                  ì‹ë‹¹ ê·¼ì²˜ì—ì„œ ë‹¤ì‹œ í™œì„±í™”í•´ì£¼ì„¸ìš”
                </p>

                <Button
                  className="w-full h-12"
                  onClick={() => {
                    onClose();
                    // ì¬í™œì„±í™” í”Œë¡œìš°ë¡œ ì´ë™
                  }}
                >
                  <RefreshCw className="w-4 h-4 mr-2" />
                  ë‹¤ì‹œ í™œì„±í™”
                </Button>
              </div>
            </>
          )}
        </div>

        <DialogFooter>
          <Button variant="outline" className="w-full" onClick={onClose}>
            ë‹«ê¸°
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
};
2.8 í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ì£¼ë¬¸ íƒ­ ì¶”ê°€)
jsx<nav className="fixed bottom-0 left-0 right-0 bg-white border-t z-50 safe-area-bottom">
  <div className="max-w-2xl mx-auto grid grid-cols-4">
    {/* í™ˆ */}
    <Link
      to="/"
      className={`flex flex-col items-center py-3 ${
        pathname === '/' ? 'text-blue-600' : 'text-gray-600'
      }`}
    >
      <Home className={`w-6 h-6 ${pathname === '/' ? 'fill-current' : ''}`} />
      <span className="text-xs mt-1">í™ˆ</span>
    </Link>

    {/* ì£¼ë¬¸ (ì‹ ê·œ) */}
    <Link
      to="/orders"
      className={`flex flex-col items-center py-3 relative ${
        pathname === '/orders' ? 'text-blue-600' : 'text-gray-600'
      }`}
    >
      <div className="relative">
        <ShoppingBag className={`w-6 h-6 ${pathname === '/orders' ? 'fill-current' : ''}`} />
        {activeOrdersCount > 0 && (
          <Badge
            variant="destructive"
            className="absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs"
          >
            {activeOrdersCount}
          </Badge>
        )}
      </div>
      <span className="text-xs mt-1">ì£¼ë¬¸</span>
    </Link>

    {/* ë‚´ ëŒ€ê¸° */}
    <Link
      to="/waiting"
      className={`flex flex-col items-center py-3 relative ${
        pathname === '/waiting' ? 'text-blue-600' : 'text-gray-600'
      }`}
    >
      <div className="relative">
        <Clock className={`w-6 h-6 ${pathname === '/waiting' ? 'fill-current' : ''}`} />
        {activeWaitingCount > 0 && (
          <Badge
            variant="destructive"
            className="absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs"
          >
            {activeWaitingCount}
          </Badge>
        )}
      </div>
      <span className="text-xs mt-1">ë‚´ ëŒ€ê¸°</span>
    </Link>

    {/* MY */}
    <Link
      to="/my"
      className={`flex flex-col items-center py-3 ${
        pathname === '/my' ? 'text-blue-600' : 'text-gray-600'
      }`}
    >
      <User className={`w-6 h-6 ${pathname === '/my' ? 'fill-current' : ''}`} />
      <span className="text-xs mt-1">MY</span>
    </Link>
  </div>
</nav>

3. ë°ì´í„° êµ¬ì¡°
3.1 ì£¼ë¬¸ ë°ì´í„°
javascript// ì£¼ë¬¸ ìƒì„± ì‹œ (ê²°ì œ ì™„ë£Œ)
{
  id: "uuid-v4",
  orderId: "ORD_20260116_001234",
  orderNumber: 47,
  userId: "user_123",
  
  // ì‹œì„¤ ì •ë³´
  facilityId: "hanyang_plaza",
  facilityName: "í•™ìƒë³µì§€ê´€ (í•œì–‘í”Œë¼ì)",
  cornerId: "hanyang_plaza_yangshik",
  cornerType: "ì–‘ì‹",
  
  // ì£¼ë¬¸ í•­ëª©
  items: [
    {
      id: "item_1",
      menuId: "menu_001",
      menu: "ì¹˜ì¦ˆëˆê¹ŒìŠ¤",
      quantity: 1,
      price: 4200
    }
  ],
  totalAmount: 4200,
  
  // ê²°ì œ ì •ë³´
  paymentMethod: "kakao",
  paymentId: "PAY_xyz",
  
  // ìƒíƒœ (í•µì‹¬)
  status: "PAID",  // PENDING, PAID, QR_ACTIVE, COMPLETED, CANCELLED, EXPIRED
  
  // QR ê´€ë ¨
  activationToken: "ACT_abc123",  // ë°œê¸‰ ê¶Œí•œ
  qrCode: null,                   // QR ë¯¸ìƒì„± ìƒíƒœ
  qrActivatedAt: null,
  qrExpiresAt: null,
  
  // ìˆ˜ë ¹ ì‹œê°„
  pickupType: "scheduled",  // "now" or "scheduled"
  pickupTime: "2026-01-16T12:30:00",
  
  // íƒ€ì„ìŠ¤íƒ¬í”„
  createdAt: "2026-01-16T11:50:00",
  paidAt: "2026-01-16T11:52:00",
  completedAt: null,
  cancelledAt: null
}

// QR í™œì„±í™” í›„
{
  ...
  status: "QR_ACTIVE",
  qrCode: "QR_def456",  // ìƒˆë¡œ ìƒì„±ë¨
  qrActivatedAt: "2026-01-16T12:28:00",
  qrExpiresAt: "2026-01-16T12:31:00"  // 3ë¶„ í›„
}

// ë§Œë£Œ í›„
{
  ...
  status: "QR_EXPIRED",
  qrCode: null,  // ë¬´íš¨í™”
  qrActivatedAt: null,
  qrExpiresAt: null
  // activationTokenì€ ìœ ì§€ (ì¬í™œì„±í™” ê°€ëŠ¥)
}

// ìŠ¤ìº” ì™„ë£Œ í›„
{
  ...
  status: "COMPLETED",
  completedAt: "2026-01-16T12:29:00"
}
3.2 QR ì½”ë“œ ë°ì´í„° (ì•”í˜¸í™”)
javascript// QR ì½”ë“œì— ë‹´ì„ ë°ì´í„°
const qrPayload = {
  orderId: "ORD_20260116_001234",
  orderNumber: 47,
  facilityId: "hanyang_plaza",
  cornerId: "hanyang_plaza_yangshik",
  activatedAt: "2026-01-16T12:28:00",
  expiresAt: "2026-01-16T12:31:00",
  items: [
    { menuId: "menu_001", quantity: 1 }
  ],
  totalAmount: 4200,
  // HMAC-SHA256 ì„œëª… (ìœ„ë³€ì¡° ë°©ì§€)
  signature: "a3f8d9e2b1c..."
};

// Base64 ì¸ì½”ë”©
const qrString = btoa(JSON.stringify(qrPayload));

// QR ìƒì„±
<QRCodeSVG value={qrString} size={220} level="H" />

4. API ì—”ë“œí¬ì¸íŠ¸
4.1 ì£¼ë¬¸ ìƒì„±
javascriptPOST /api/orders
{
  "facilityId": "hanyang_plaza",
  "cornerId": "hanyang_plaza_yangshik",
  "items": [
    {
      "menuId": "menu_001",
      "menu": "ì¹˜ì¦ˆëˆê¹ŒìŠ¤",
      "quantity": 1,
      "price": 4200
    }
  ],
  "pickupType": "scheduled",
  "pickupTime": "2026-01-16T12:30:00",
  "paymentMethod": "kakao"
}

// ì‘ë‹µ
{
  "success": true,
  "order": {
    "orderId": "ORD_20260116_001234",
    "orderNumber": 47,
    "status": "PENDING",
    "activationToken": "ACT_abc123",
    "totalAmount": 4200,
    "paymentUrl": "https://payment-gateway.com/pay/xxx"
  }
}
4.2 ê²°ì œ ì™„ë£Œ ì›¹í›… (PGì‚¬ â†’ ì„œë²„)
javascriptPOST /api/payments/webhook
{
  "orderId": "ORD_20260116_001234",
  "paymentId": "PAY_xyz",
  "status": "SUCCESS",
  "amount": 4200
}

// ì„œë²„ ì²˜ë¦¬:
// 1. ì£¼ë¬¸ ìƒíƒœ: PENDING â†’ PAID
// 2. ì‹ê¶Œ ë³´ê´€í•¨ì— ì €ì¥
// 3. ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
4.3 QR í™œì„±í™”
javascriptPOST /api/orders/:orderId/activate-qr
{
  "userLocation": {
    "lat": 37.5575,
    "lng": 127.0469
  }
}

// ì‘ë‹µ (ì„±ê³µ)
{
  "success": true,
  "qrCode": "QR_def456",
  "activatedAt": "2026-01-16T12:28:00",
  "expiresAt": "2026-01-16T12:31:00",
  "expiresIn": 180
}

// ì‘ë‹µ (ê±°ë¦¬ ì´ˆê³¼)
{
  "success": false,
  "reason": "TOO_FAR",
  "distance": 350,
  "required": 50,
  "message": "ì‹ë‹¹ì—ì„œ 350m ë–¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤"
}

// ì‘ë‹µ (ì´ë¯¸ ì™„ë£Œë¨)
{
  "success": false,
  "reason": "ALREADY_COMPLETED",
  "message": "ì´ë¯¸ ì‚¬ìš©ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤"
}
4.4 QR ê²€ì¦ (ì‹ë‹¹ ìŠ¤ìºë„ˆ)
javascriptPOST /api/orders/verify
{
  "qrCode": "QR_def456",
  "facilityId": "hanyang_plaza"
}

// ì‘ë‹µ (ì„±ê³µ)
{
  "valid": true,
  "order": {
    "orderNumber": 47,
    "items": [
      { "menu": "ì¹˜ì¦ˆëˆê¹ŒìŠ¤", "quantity": 1 }
    ],
    "totalAmount": 4200,
    "customerName": "í™ê¸¸ë™"
  }
}

// ì‘ë‹µ (ë§Œë£Œë¨)
{
  "valid": false,
  "reason": "EXPIRED",
  "message": "QR ì½”ë“œê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤"
}

// ì‘ë‹µ (ì´ë¯¸ ì‚¬ìš©ë¨)
{
  "valid": false,
  "reason": "ALREADY_USED",
  "message": "ì´ë¯¸ ì‚¬ìš©ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤"
}
4.5 ë‚´ ì£¼ë¬¸ ì¡°íšŒ
javascriptGET /api/orders/my?status=active

// ì‘ë‹µ
{
  "orders": [
    {
      "orderId": "ORD_20260116_001234",
      "orderNumber": 47,
      "status": "PAID",
      "facility": { ... },
      "items": [ ... ],
      "totalAmount": 4200,
      "pickupTime": "2026-01-16T12:30:00",
      "createdAt": "2026-01-16T11:50:00"
    }
  ]
}
4.6 ì£¼ë¬¸ ì·¨ì†Œ
javascriptPOST /api/orders/:orderId/cancel

// ì‘ë‹µ
{
  "success": true,
  "refundAmount": 4200,
  "message": "ì£¼ë¬¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤"
}

5. ë°±ì—”ë“œ ë¡œì§
5.1 QR í™œì„±í™” ì²˜ë¦¬
javascript// server/routes/orders.js

app.post('/api/orders/:orderId/activate-qr', async (req, res) => {
  try {
    const { orderId } = req.params;
    const { userLocation } = req.body;

    // 1. ì£¼ë¬¸ ì¡°íšŒ
    const order = await db.orders.findOne({
      where: { orderId }
    });

    if (!order) {
      return res.json({
        success: false,
        reason: 'NOT_FOUND',
        message: 'ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'
      });
    }

    // 2. ìƒíƒœ í™•ì¸
    if (order.status === 'COMPLETED') {
      return res.json({
        success: false,
        reason: 'ALREADY_COMPLETED',
        message: 'ì´ë¯¸ ì‚¬ìš©ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤'
      });
    }

    if (order.status === 'CANCELLED') {
      return res.json({
        success: false,
        reason: 'CANCELLED',
        message: 'ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤'
      });
    }

    if (order.status !== 'PAID' && order.status !== 'QR_EXPIRED') {
      return res.json({
        success: false,
        reason: 'INVALID_STATUS',
        message: 'í™œì„±í™”í•  ìˆ˜ ì—†ëŠ” ìƒíƒœì…ë‹ˆë‹¤'
      });
    }

    // 3. GPS ê±°ë¦¬ í™•ì¸
    const facility = await db.facilities.findOne({
      where: { id: order.facilityId }
    });

    const distance = calculateDistance(
      userLocation.lat,
      userLocation.lng,
      facility.location.lat,
      facility.location.lng
    );

    if (distance > 50) {
      return res.json({
        success: false,
        reason: 'TOO_FAR',
        distance: Math.round(distance),
        required: 50,
        message: `ì‹ë‹¹ì—ì„œ ${Math.round(distance)}m ë–¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤`
      });
    }

    // 4. QR ì½”ë“œ ìƒì„±
    const now = new Date();
    const expiresAt = new Date(now.getTime() + 3 * 60 * 1000); // 3ë¶„ í›„

    const qrPayload = {
      orderId: order.orderId,
      orderNumber: order.orderNumber,
      facilityId: order.facilityId,
      cornerId: order.cornerId,
      activatedAt: now.toISOString(),
      expiresAt: expiresAt.toISOString(),
      items: order.items,
      totalAmount: order.totalAmount,
      signature: generateSignature({
        orderId: order.orderId,
        activatedAt: now.toISOString()
      })
    };

    const qrCode = btoa(JSON.stringify(qrPayload));

    // 5. DB ì—…ë°ì´íŠ¸
    await db.orders.update({
      where: { orderId },
      data: {
        status: 'QR_ACTIVE',
        qrCode,
        qrActivatedAt: now,
        qrExpiresAt: expiresAt
      }
    });

    // 6. ì„±ê³µ ì‘ë‹µ
    res.json({
      success: true,
      qrCode,
      activatedAt: now.toISOString(),
      expiresAt: expiresAt.toISOString(),
      expiresIn: 180
    });

  } catch (error) {
    res.status(500).json({
      success: false,
      reason: 'SERVER_ERROR',
      message: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'
    });
  }
});
5.2 QR ë§Œë£Œ ì²˜ë¦¬ (í¬ë¡ ì¡)
javascript// server/jobs/expireQR.js

const cron = require('node-cron');

// ë§¤ 1ë¶„ë§ˆë‹¤ ì‹¤í–‰
cron.schedule('* * * * *', async () => {
  const now = new Date();

  // ë§Œë£Œëœ QR ì°¾ê¸°
  const expiredOrders = await db.orders.findMany({
    where: {
      status: 'QR_ACTIVE',
      qrExpiresAt: {
        lte: now
      }
    }
  });

  // ìƒíƒœ ì—…ë°ì´íŠ¸
  for (const order of expiredOrders) {
    await db.orders.update({
      where: { orderId: order.orderId },
      data: {
        status: 'QR_EXPIRED',
        qrCode: null,
        qrActivatedAt: null,
        qrExpiresAt: null
      }
    });

    // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ (ì„ íƒ)
    await sendNotification(order.userId, {
      title: 'QR ì½”ë“œ ë§Œë£Œ',
      body: `ì£¼ë¬¸ #${order.orderNumber}ì˜ QRì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì¬í™œì„±í™”í•˜ì„¸ìš”.`
    });
  }
});
5.3 QR ê²€ì¦ ë¡œì§
javascript// server/routes/orders.js

app.post('/api/orders/verify', async (req, res) => {
  try {
    const { qrCode, facilityId } = req.body;

    // 1. QR ë””ì½”ë”©
    let payload;
    try {
      payload = JSON.parse(atob(qrCode));
    } catch (e) {
      return res.json({
        valid: false,
        reason: 'INVALID_QR',
        message: 'ìœ íš¨í•˜ì§€ ì•Šì€ QR ì½”ë“œì…ë‹ˆë‹¤'
      });
    }

    // 2. ì„œëª… ê²€ì¦
    const expectedSignature = generateSignature({
      orderId: payload.orderId,
      activatedAt: payload.activatedAt
    });

    if (payload.signature !== expectedSignature) {
      return res.json({
        valid: false,
        reason: 'FORGED',
        message: 'QR ì½”ë“œê°€ ìœ„ì¡°ë˜ì—ˆìŠµë‹ˆë‹¤'
      });
    }

    // 3. ì£¼ë¬¸ ì¡°íšŒ
    const order = await db.orders.findOne({
      where: { orderId: payload.orderId }
    });

    if (!order) {
      return res.json({
        valid: false,
        reason: 'NOT_FOUND',
        message: 'ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'
      });
    }

    // 4. ì‹œì„¤ í™•ì¸
    if (order.facilityId !== facilityId) {
      return res.json({
        valid: false,
        reason: 'WRONG_FACILITY',
        message: 'ë‹¤ë¥¸ ì‹ë‹¹ì˜ ì£¼ë¬¸ì…ë‹ˆë‹¤'
      });
    }

    // 5. ìƒíƒœ í™•ì¸
    if (order.status === 'COMPLETED') {
      return res.json({
        valid: false,
        reason: 'ALREADY_USED',
        message: 'ì´ë¯¸ ì‚¬ìš©ëœ ì£¼ë¬¸ì…ë‹ˆë‹¤'
      });
    }

    if (order.status !== 'QR_ACTIVE') {
      return res.json({
        valid: false,
        reason: 'INACTIVE',
        message: 'QRì´ í™œì„±í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤'
      });
    }

    // 6. ìœ íš¨ì‹œê°„ í™•ì¸
    const now = new Date();
    const expiresAt = new Date(payload.expiresAt);

    if (now > expiresAt) {
      // ë§Œë£Œ ì²˜ë¦¬
      await db.orders.update({
        where: { orderId: order.orderId },
        data: {
          status: 'QR_EXPIRED',
          qrCode: null,
          qrActivatedAt: null,
          qrExpiresAt: null
        }
      });

      return res.json({
        valid: false,
        reason: 'EXPIRED',
        message: 'QR ì½”ë“œê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤'
      });
    }

    // 7. QR ì½”ë“œ ì¼ì¹˜ í™•ì¸
    if (order.qrCode !== qrCode) {
      return res.json({
        valid: false,
        reason: 'MISMATCH',
        message: 'QR ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤'
      });
    }

    // 8. ì£¼ë¬¸ ì™„ë£Œ ì²˜ë¦¬
    await db.orders.update({
      where: { orderId: order.orderId },
      data: {
        status: 'COMPLETED',
        completedAt: now
      }
    });

    // 9. ì„±ê³µ ì‘ë‹µ
    res.json({
      valid: true,
      order: {
        orderNumber: order.orderNumber,
        items: order.items,
        totalAmount: order.totalAmount,
        customerName: order.customerName || 'ê³ ê°'
      }
    });

  } catch (error) {
    res.status(500).json({
      valid: false,
      reason: 'SERVER_ERROR',
      message: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'
    });
  }
});

6. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (SQLite)
sql-- ì£¼ë¬¸ í…Œì´ë¸”
CREATE TABLE orders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  order_id TEXT UNIQUE NOT NULL,
  order_number INTEGER NOT NULL,
  user_id TEXT,
  
  -- ì‹œì„¤ ì •ë³´
  facility_id TEXT NOT NULL,
  facility_name TEXT NOT NULL,
  corner_id TEXT NOT NULL,
  corner_type TEXT NOT NULL,
  
  -- ì£¼ë¬¸ í•­ëª© (JSON)
  items TEXT NOT NULL,
  total_amount INTEGER NOT NULL,
  
  -- ê²°ì œ ì •ë³´
  payment_method TEXT NOT NULL,
  payment_id TEXT,
  
  -- ìƒíƒœ
  status TEXT NOT NULL DEFAULT 'PENDING',
  -- PENDING, PAID, QR_ACTIVE, QR_EXPIRED, COMPLETED, CANCELLED
  
  -- QR ê´€ë ¨
  activation_token TEXT NOT NULL,
  qr_code TEXT,
  qr_activated_at DATETIME,
  qr_expires_at DATETIME,
  
  -- ìˆ˜ë ¹ ì‹œê°„
  pickup_type TEXT NOT NULL,
  pickup_time DATETIME,
  
  -- íƒ€ì„ìŠ¤íƒ¬í”„
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  paid_at DATETIME,
  completed_at DATETIME,
  cancelled_at DATETIME,
  
  FOREIGN KEY (facility_id) REFERENCES facilities(id)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_facility ON orders(facility_id);
CREATE INDEX idx_orders_qr_expires ON orders(qr_expires_at);

7. í”„ë¡ íŠ¸ì—”ë“œ Hooks
7.1 ì£¼ë¬¸ ê´€ë¦¬ í›…
javascript// hooks/useOrders.js
import { useState, useEffect } from 'react';

export const useOrders = () => {
  const [orders, setOrders] = useState([]);
  const [loading, setLoading] = useState(true);

  // ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ
  const fetchOrders = async () => {
    try {
      const response = await fetch('/api/orders/my');
      const data = await response.json();
      setOrders(data.orders);
    } catch (error) {
      console.error('Failed to fetch orders:', error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchOrders();
    
    // 30ì´ˆë§ˆë‹¤ í´ë§
    const interval = setInterval(fetchOrders, 30000);
    return () => clearInterval(interval);
  }, []);

  // ì£¼ë¬¸ ìƒì„±
  const createOrder = async (orderData) => {
    const response = await fetch('/api/orders', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(orderData)
    });
    return response.json();
  };

  // QR í™œì„±í™”
  const activateQR = async (orderId, userLocation) => {
    const response = await fetch(`/api/orders/${orderId}/activate-qr`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ userLocation })
    });
    const result = await response.json();
    
    if (result.success) {
      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸
      setOrders(prev => prev.map(order =>
        order.orderId === orderId
          ? {
              ...order,
              status: 'QR_ACTIVE',
              qrCode: result.qrCode,
              qrActivatedAt: result.activatedAt,
              qrExpiresAt: result.expiresAt
            }
          : order
      ));
    }
    
    return result;
  };

  // ì£¼ë¬¸ ì·¨ì†Œ
  const cancelOrder = async (orderId) => {
    const response = await fetch(`/api/orders/${orderId}/cancel`, {
      method: 'POST'
    });
    const result = await response.json();
    
    if (result.success) {
      await fetchOrders(); // ìƒˆë¡œê³ ì¹¨
    }
    
    return result;
  };

  const activeOrders = orders.filter(o => 
    ['PAID', 'QR_ACTIVE'].includes(o.status)
  );

  const completedOrders = orders.filter(o => 
    o.status === 'COMPLETED'
  );

  return {
    orders,
    activeOrders,
    completedOrders,
    loading,
    createOrder,
    activateQR,
    cancelOrder,
    refetch: fetchOrders
  };
};
7.2 ì¥ë°”êµ¬ë‹ˆ í›…
javascript// hooks/useCart.js
import { useState, useEffect } from 'react';

export const useCart = () => {
  const [items, setItems] = useState([]);

  // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
  useEffect(() => {
    const saved = localStorage.getItem('cart');
    if (saved) {
      setItems(JSON.parse(saved));
    }
  }, []);

  // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
  useEffect(() => {
    localStorage.setItem('cart', JSON.stringify(items));
  }, [items]);

  // ì•„ì´í…œ ì¶”ê°€
  const addItem = (item) => {
    setItems(prev => {
      const existing = prev.find(i => i.id === item.id);
      if (existing) {
        return prev.map(i =>
          i.id === item.id
            ? { ...i, quantity: i.quantity + 1 }
            : i
        );
      }
      return [...prev, { ...item, quantity: 1 }];
    });
  };

  // ìˆ˜ëŸ‰ ì¦ê°€
  const increaseQuantity = (itemId) => {
    setItems(prev => prev.map(i =>
      i.id === itemId && i.quantity < 5
        ? { ...i, quantity: i.quantity + 1 }
        : i
    ));
  };

  // ìˆ˜ëŸ‰ ê°ì†Œ
  const decreaseQuantity = (itemId) => {
    setItems(prev => prev.map(i =>
      i.id === itemId && i.quantity > 1
        ? { ...i, quantity: i.quantity - 1 }
        : i
    ));
  };

  // ì•„ì´í…œ ì œê±°
  const removeItem = (itemId) => {
    setItems(prev => prev.filter(i => i.id !== itemId));
  };

  // ì¥ë°”êµ¬ë‹ˆ ë¹„ìš°ê¸°
  const clearCart = () => {
    setItems([]);
  };

  // ì´ ê¸ˆì•¡
  const totalAmount = items.reduce(
    (sum, item) => sum + item.price * item.quantity,
    0
  );

  return {
    items,
    totalAmount,
    addItem,
    increaseQuantity,
    decreaseQuantity,
    removeItem,
    clearCart
  };
};

8. ì‹ë‹¹ ì¸¡ ìŠ¤ìºë„ˆ ì•± (íƒœë¸”ë¦¿ìš©)
jsx// pages/Scanner.jsx

const ScannerPage = () => {
  const [scanning, setScanning] = useState(false);
  const [lastOrder, setLastOrder] = useState(null);
  const [error, setError] = useState(null);

  const handleScan = async (qrCode) => {
    try {
      setError(null);

      // QR ê²€ì¦ ìš”ì²­
      const response = await fetch('/api/orders/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          qrCode,
          facilityId: FACILITY_ID // íƒœë¸”ë¦¿ë³„ ì„¤ì •
        })
      });

      const result = await response.json();

      if (result.valid) {
        // ì„±ê³µ
        setLastOrder(result.order);
        playSuccessSound();
        navigator.vibrate?.([200, 100, 200, 100, 200]);
        
        // 3ì´ˆ í›„ ìë™ìœ¼ë¡œ ë‹¤ìŒ ìŠ¤ìº” ì¤€ë¹„
        setTimeout(() => {
          setLastOrder(null);
          setScanning(true);
        }, 3000);
      } else {
        // ì‹¤íŒ¨
        setError(result.message);
        playErrorSound();
        navigator.vibrate?.([500]);
      }
    } catch (error) {
      setError('QR ì½”ë“œ ê²€ì¦ ì‹¤íŒ¨');
      playErrorSound();
    }
  };

  return (
    <div className="h-screen flex flex-col bg-gray-100">
      {/* ìƒë‹¨: ì‹ë‹¹ ì •ë³´ */}
      <header className="bg-blue-600 text-white p-4">
        <h1 className="text-xl font-bold">í•™ìƒë³µì§€ê´€ (í•œì–‘í”Œë¼ì)</h1>
        <p className="text-sm opacity-90">ì–‘ì‹ ì½”ë„ˆ - QR ìŠ¤ìºë„ˆ</p>
      </header>

      {/* ì¤‘ì•™: ì¹´ë©”ë¼ ë˜ëŠ” ê²°ê³¼ */}
      <div className="flex-1 relative">
        {scanning && !lastOrder && !error && (
          <div className="h-full bg-black">
            <QrReader
              onResult={(result) => {
                if (result) {
                  handleScan(result?.text);
                  setScanning(false);
                }
              }}
              constraints={{ facingMode: 'environment' }}
              className="w-full h-full"
            />
            
            {/* ìŠ¤ìº” ê°€ì´ë“œ */}
            <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
              <div className="w-64 h-64 border-4 border-white rounded-2xl" />
              <p className="absolute bottom-20 text-white text-lg font-semibold">
                QR ì½”ë“œë¥¼ í™”ë©´ ì¤‘ì•™ì— ë§ì¶°ì£¼ì„¸ìš”
              </p>
            </div>
          </div>
        )}

        {/* ì„±ê³µ í™”ë©´ */}
        {lastOrder && (
          <div className="h-full bg-green-50 flex items-center justify-center p-8">
            <div className="max-w-md w-full">
              <div className="text-center mb-6">
                <div className="mx-auto mb-4 h-24 w-24 rounded-full bg-green-100 flex items-center justify-center animate-scale">
                  <CheckCircle className="h-16 w-16 text-green-600" />
                </div>
                <h2 className="text-3xl font-bold text-green-900 mb-2">
                  ì£¼ë¬¸ í™•ì¸ ì™„ë£Œ
                </h2>
                <p className="text-lg text-green-700">
                  ìŒì‹ì„ ì œê³µí•´ì£¼ì„¸ìš”
                </p>
              </div>

              <Card className="border-2 border-green-200">
                <CardContent className="p-6">
                  <div className="text-center mb-4">
                    <p className="text-sm text-gray-600 mb-1">ì£¼ë¬¸ë²ˆí˜¸</p>
                    <p className="text-5xl font-bold text-blue-600">
                      #{lastOrder.orderNumber}
                    </p>
                  </div>

                  <Separator className="my-4" />

                  <div className="space-y-2">
                    {lastOrder.items.map((item, index) => (
                      <div key={index} className="flex justify-between items-center">
                        <span className="text-2xl font-semibold">
                          {item.menu}
                        </span>
                        <span className="text-2xl text-gray-600">
                          x{item.quantity}
                        </span>
                      </div>
                    ))}
                  </div>

                  <Separator className="my-4" />

                  <div className="flex justify-between items-center">
                    <span className="text-lg text-gray-600">ì´ ê¸ˆì•¡</span>
                    <span className="text-2xl font-bold">
                      â‚©{lastOrder.totalAmount.toLocaleString()}
                    </span>
                  </div>
                </CardContent>
              </Card>
            </div>
          </div>
        )}

        {/* ì—ëŸ¬ í™”ë©´ */}
        {error && (
          <div className="h-full bg-red-50 flex items-center justify-center p-8">
            <div className="max-w-md w-full text-center">
              <div className="mx-auto mb-4 h-24 w-24 rounded-full bg-red-100 flex items-center justify-center">
                <XCircle className="h-16 w-16 text-red-600" />
              </div>
              <h2 className="text-3xl font-bold text-red-900 mb-2">
                ê²€ì¦ ì‹¤íŒ¨
              </h2>
              <p className="text-lg text-red-700 mb-6">
                {error}
              </p>
              <Button
                size="lg"
                onClick={() => {
                  setError(null);
                  setScanning(true);
                }}
              >
                ë‹¤ì‹œ ìŠ¤ìº”
              </Button>
            </div>
          </div>
        )}

        {/* ëŒ€ê¸° í™”ë©´ */}
        {!scanning && !lastOrder && !error && (
          <div className="h-full flex items-center justify-center">
            <div className="text-center">
              <QrCode className="w-32 h-32 text-gray-300 mx-auto mb-4" />
              <p className="text-xl text-gray-500">ìŠ¤ìº” ëŒ€ê¸° ì¤‘</p>
            </div>
          </div>
        )}
      </div>

      {/* í•˜ë‹¨: ìŠ¤ìº” ë²„íŠ¼ */}
      <div className="p-4 bg-white border-t">
        {!scanning && !lastOrder && (
          <Button
            className="w-full h-16 text-xl"
            onClick={() => setScanning(true)}
          >
            <QrCode className="w-6 h-6 mr-2" />
            QR ìŠ¤ìº” ì‹œì‘
          </Button>
        )}
        {scanning && (
          <Button
            variant="outline"
            className="w-full h-16 text-xl"
            onClick={() => setScanning(false)}
          >
            ìŠ¤ìº” ì¤‘ì§€
          </Button>
        )}
      </div>
    </div>
  );
};

9. ì‹œë®¬ë ˆì´ì…˜ (Replitìš©)
9.1 ê²°ì œ ì‹œë®¬ë ˆì´ì…˜
javascript// utils/paymentSimulator.js

export const simulatePayment = async (paymentMethod, amount) => {
  // 2ì´ˆ ëŒ€ê¸° (ê²°ì œ ì²˜ë¦¬ ì‹œë®¬ë ˆì´ì…˜)
  await new Promise(resolve => setTimeout(resolve, 2000));

  // 90% í™•ë¥ ë¡œ ì„±ê³µ
  const success = Math.random() > 0.1;

  if (success) {
    return {
      success: true,
      paymentId: `PAY_${Date.now()}`,
      amount,
      method: paymentMethod
    };
  } else {
    throw new Error('ê²°ì œ ì‹¤íŒ¨');
  }
};
9.2 QR ìƒì„± ì‹œë®¬ë ˆì´ì…˜
javascript// ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” HMAC-SHA256 ì‚¬ìš©
// Replitì—ì„œëŠ” ê°„ë‹¨í•œ í•´ì‹œ

export const generateQRCode = (orderData) => {
  const payload = {
    ...orderData,
    timestamp: Date.now(),
    signature: btoa(`${orderData.orderId}-${Date.now()}`)
  };

  return btoa(JSON.stringify(payload));
};

10. êµ¬í˜„ ìˆœì„œ
Phase 1: ì£¼ë¬¸ ì‹œìŠ¤í…œ ê¸°ë³¸ (2ì¼)

âœ… ì¥ë°”êµ¬ë‹ˆ UI
âœ… ì¥ë°”êµ¬ë‹ˆ Hook (ë¡œì»¬ìŠ¤í† ë¦¬ì§€)
âœ… ì£¼ë¬¸ ìƒì„± API
âœ… ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ëª¨ë‹¬
âœ… ê²°ì œ ì‹œë®¬ë ˆì´ì…˜

Phase 2: ì‹ê¶Œ ë³´ê´€í•¨ (1ì¼)

âœ… ê²°ì œ ì™„ë£Œ í™”ë©´ (ë³´ê´€í•¨ ì €ì¥ ì•ˆë‚´)
âœ… ì£¼ë¬¸ ëª©ë¡ í™”ë©´ ("ì£¼ë¬¸" íƒ­ ì¶”ê°€)
âœ… ì£¼ë¬¸ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
âœ… í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ì—…ë°ì´íŠ¸

Phase 3: QR í™œì„±í™” (2ì¼)

âœ… QR í™œì„±í™” í”Œë¡œìš°
âœ… GPS í˜„ì¥ ì¸ì¦
âœ… QR ì½”ë“œ ìƒì„±
âœ… 3ë¶„ íƒ€ì´ë¨¸ êµ¬í˜„
âœ… QR í‘œì‹œ ëª¨ë‹¬

Phase 4: QR ê²€ì¦ (1ì¼)

âœ… ì‹ë‹¹ ìŠ¤ìºë„ˆ ì•±
âœ… QR ê²€ì¦ API
âœ… ì£¼ë¬¸ ì™„ë£Œ ì²˜ë¦¬
âœ… ì„±ê³µ/ì‹¤íŒ¨ í”¼ë“œë°±

Phase 5: ì¶”ê°€ ê¸°ëŠ¥ (1ì¼)

âœ… ì£¼ë¬¸ ì·¨ì†Œ
âœ… ì´ìš© ë‚´ì—­
âœ… QR ë§Œë£Œ ì²˜ë¦¬ (í¬ë¡ ì¡)
âœ… ì¬í™œì„±í™” í”Œë¡œìš°

ì´ ì˜ˆìƒ ê¸°ê°„: 7ì¼

11. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
11.1 QR ìœ„ë³€ì¡° ë°©ì§€
javascript// HMAC-SHA256 ì„œëª…
import crypto from 'crypto';

const generateSignature = (data) => {
  const secret = process.env.QR_SECRET_KEY;
  return crypto
    .createHmac('sha256', secret)
    .update(JSON.stringify(data))
    .digest('hex');
};
11.2 GPS ìŠ¤í‘¸í•‘ ëŒ€ì‘

í”„ë¡ íŠ¸ì—”ë“œ GPSëŠ” ì°¸ê³ ìš©
ì¤‘ìš”í•œ ê²€ì¦ì€ ì„œë²„ì—ì„œ ì¶”ê°€ í™•ì¸
ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŒ¨í„´ ëª¨ë‹ˆí„°ë§

11.3 QR ì¬ì‚¬ìš© ë°©ì§€

ìŠ¤ìº” ì¦‰ì‹œ DB ìƒíƒœ ì—…ë°ì´íŠ¸
íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¡œ ë™ì‹œ ìŠ¤ìº” ë°©ì§€


ì‚°ì¶œë¬¼ ìš”ì•½
âœ… ì™„ì „íˆ ì‘ë™í•˜ëŠ” ê¸°ëŠ¥

ì£¼ë¬¸ ì‹œìŠ¤í…œ: ë©”ë‰´ ì„ íƒ â†’ ì¥ë°”êµ¬ë‹ˆ â†’ ê²°ì œ
ì‹ê¶Œ ë³´ê´€í•¨: ê²°ì œ ì™„ë£Œ í›„ ì•ˆì „ ë³´ê´€
QR í™œì„±í™”: GPS ì¸ì¦ â†’ 3ë¶„ íƒ€ì´ë¨¸
QR ê²€ì¦: ì‹ë‹¹ ìŠ¤ìºë„ˆ â†’ ì£¼ë¬¸ ì™„ë£Œ
ì£¼ë¬¸ ê´€ë¦¬: ëª©ë¡/ì·¨ì†Œ/ì´ìš©ë‚´ì—­

âš ï¸ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ ì—°ë™ ëŒ€ê¸°)

ê²°ì œ PG: ì¹´ì¹´ì˜¤/í† ìŠ¤ ì—°ë™ ëŒ€ê¸° (í˜„ì¬ ì‹œë®¬ë ˆì´ì…˜)
HMAC ì„œëª…: ë‹¨ìˆœ í•´ì‹œ ì‚¬ìš© (ì‹¤ì œë¡  HMAC-SHA256)

ğŸ¯ í•µì‹¬ ì°¨ë³„ì 

âœ… ëŒ€ê¸°ì¤„ ê±´ë„ˆë›°ê¸°
âœ… ë¯¸ë¦¬ ì£¼ë¬¸ ê°€ëŠ¥
âœ… GPS ê¸°ë°˜ í˜„ì¥ ì¸ì¦
âœ… 3ë¶„ ì œí•œìœ¼ë¡œ ë³´ì•ˆ ê°•í™”
âœ… ë¬´ì œí•œ ì¬í™œì„±í™”